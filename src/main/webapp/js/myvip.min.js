function isMobile(e){return/^((\(\d{2,3}\))|(\d{3}\-))?(1[34578]\d{9})$/.test(e)}function isMail(e){return/^[-_A-Za-z0-9]+@([_A-Za-z0-9]+\.)+[A-Za-z0-9]{2,3}$/.test(e)}var myvip={init:function(){this.bindE(),this.getNav(),this.exNav(),this.comSwipe()},bindE:function(){$("#exchangeF").on("click",myvip.exchangeFma),$("#vali-send").on("click",myvip.getCode),$("#vali-email").on("click",myvip.emailGet),$("#vali-phonebtn").on("click",myvip.phoneGet)},getNavkey:!0,getNav:function(){var e,t;$("#getvipNav li").each(function(i){var n=$(this);n.on("click",function(){var a=$("#getvipCon li")[i];"block"!==$(a).css("display")&&"list-item"!==$(a).css("display")&&myvip.getNavkey&&(myvip.getNavkey=!1,$("#getvipNav li").removeClass("active"),n.addClass("active"),$("#getvipCon li").fadeOut(100),e=setTimeout(function(){$("#getvipCon li").eq(i).fadeIn(100)},100),t=setTimeout(function(){myvip.getNavkey=!0},210))})})},exNavkey:!0,exNav:function(){var e,t;$("#exNav li").each(function(i){var n=$(this);n.on("click",function(){var a=$("#exCon li")[i];"block"!==$(a).css("display")&&"list-item"!==$(a).css("display")&&myvip.exNavkey&&(myvip.exNavkey=!1,$("#exNav li").removeClass("active"),n.addClass("active"),$("#exCon li").fadeOut(100),e=setTimeout(function(){$("#exCon li").eq(i).fadeIn(100)},100),t=setTimeout(function(){myvip.exNavkey=!0},210))})})},comSwipe:function(){function e(e){function t(){m<0&&parseInt(n.css("left"))>i||m>0&&parseInt(n.css("left"))<i?(n.css("left",parseInt(n.css("left"))+m+"px"),setTimeout(t,s)):(a=!1,n.css("left",i+"px"),i>-210&&n.css("left","-420px"),i<-420&&n.css("left","-210px"))}a=!0;var i=parseInt(n.css("left"))+e,o=300,s=10,m=e/(o/s);t()}var t=$("#com-left"),i=$("#com-right"),n=$(".comment-swiper"),a=!1;t.click(function(){a||e(210)}),i.click(function(){a||e(-210)})},getFmaKey:!0,exchangeFma:function(e){e.preventDefault();var t="http://my."+baseUrl+"/api/fcodeCheck",i=$("#exchangeF-text").val().trim(),n={fcode:i};if(myvip.getFmaKey){if(myvip.getFmaKey=!1,""===i)return SJKXY.msgBox(0,"请输入F码"),void(myvip.getFmaKey=!0);$.ajax({url:t,data:n,type:"get",dataType:"jsonp",jsonp:"jsoncallback",success:function(e){200==e.code?(SJKXY.msgBox(1,e.msg),myvip.getFmaKey=!0):(SJKXY.msgBox(0,e.msg),myvip.getFmaKey=!0)},error:function(){SJKXY.msgBox(0,"网络错误"),myvip.getFmaKey=!0}})}},getCodeKey:!0,getCode:function(e){e.preventDefault();var t,i="http://my."+baseUrl+"/api/sendPhone",n=$("#vali-send"),a=$("#vali-phone").val().trim(),o={phone:a,send_type:1};if(myvip.getCodeKey){if(myvip.getCodeKey=!1,""===a)return SJKXY.msgBox(0,"请输入手机号"),void(myvip.getCodeKey=!0);if(!isMobile(a))return SJKXY.msgBox(0,"手机号格式不正确"),void(myvip.getCodeKey=!0);$.ajax({url:i,data:o,type:"get",dataType:"jsonp",jsonp:"jsoncallback",success:function(e){200==e.status||200==e.code?(n.html('<span class="timeCount">60</span>后重新获取'),n.addClass("dis-btn"),t=setInterval(function(){var e=parseInt(n.find(".timeCount").text());0===e?(n.html("重新获取"),clearTimeout(t),myvip.getCodeKey=!0):n.find(".timeCount").text(--e)},1e3)):(n.text("获取失败"),setTimeout(function(){n.text("重新获取")},1e3),SJKXY.msgBox(0,e.msg),myvip.getCodeKey=!0)},error:function(){n.text("获取失败"),setTimeout(function(){n.text("重新获取")},1e3),SJKXY.msgBox(0,"服务器错误，请重试！"),myvip.getCodeKey=!0}})}},phoneKey:!0,phoneGet:function(e){e.preventDefault();var t,i,n="http://my."+baseUrl+"/api/setPhone",a=$("#vali-phone").val().trim(),o=$("#vali-input").val().trim(),s={phone:a,sms:o};return t="<h3>验证手机号 获取<span>3天VIP</span></h3>",t+='<p class="vali-over">已成功验证手机号</p>',t+='<button class="vali-btn gray-btn" >已获取</button>',""===a?void SJKXY.msgBox(0,"请输入手机号"):isMobile(a)?""===o?void SJKXY.msgBox(0,"请输入验证码"):void(myvip.phoneKey&&(myvip.phoneKey=!1,$.ajax({url:n,data:s,type:"get",dataType:"jsonp",jsonp:"jsoncallback",success:function(e){200==e.code?(SJKXY.msgBox(1,"验证手机号成功"),myvip.phoneKey=!0,i=setTimeout(function(){$(".vali-left").html(t)},500)):(SJKXY.msgBox(0,e.msg),myvip.phoneKey=!0)},error:function(e){SJKXY.msgBox(0,e.msg),myvip.phoneKey=!0}}))):void SJKXY.msgBox(0,"手机号格式不正确")},emailKey:!0,emailGet:function(e){e.preventDefault();var t="http://my."+baseUrl+"/api/sendEmail",i=$("#vali-eimal-val").val().trim(),n={email:i};return""===i?void SJKXY.msgBox(0,"请输入邮箱"):isMail(i)?void(myvip.emailKey&&(myvip.emailKey=!1,$.ajax({url:t,data:n,type:"get",dataType:"jsonp",jsonp:"jsoncallback",success:function(e){200==e.code?(SJKXY.msgBox(1,"我们已经发送一封邮件到您的邮箱，请尽快查收邮件！ 如果没有收到您可以看看垃圾邮件， 或重新绑定"),myvip.emailKey=!0):(SJKXY.msgBox(0,e.msg),myvip.emailKey=!0)},error:function(){SJKXY.msgBox(0,"服务器错误，请重试！"),myvip.emailKey=!0}}))):void SJKXY.msgBox(0,"邮箱不正确")}};$(function(){myvip.init()});