define("vip:widget/vip/vip.js",function(t,e,a){var o=o||{};o={timestamp:"",Lock:!0,init:function(){this.bind()},bind:function(){$(".card-list>dl>dd").on("click",this.choosed),$("#gopay").on("click",this.wxPay),$(".wclose").on("click",this.closeWechat),$(".tozhifubao").on("click",this.alipay)},choosed:function(){$(".card-list>dl>dd").removeClass("choosed"),$(this).addClass("choosed");var t=$(this).find(".vip-time").attr("data");$(".orinagebtn").attr("data",t)},closeWechat:function(){o.Lock=!0,$(".mask").hide(),$(".wechat-pay-container").hide(),o.sendNum=999},wxPay:function(){{var t=$(".orinagebtn").attr("data").split("_"),e=t[0],a=t[1];t[2]}return o.Lock?(o.Lock=!1,void $.ajax({url:"/vip/createorder",cache:!1,type:"get",datatype:"json",data:{good_id:e,buy_num:a},success:function(t){"200"==t.code?(o.timestamp=t.data.timestamp,o.wxsucc(t)):alert(t.msg)},error:function(){alert("网络请求失败!")}})):!1},wxsucc:function(t){$(".price").text(t.data.real_money),$(".codeimg").attr("src",t.data.png_base64),$(".mask").show(),$(".wechat-pay-container").show();var e="/vip/alipay.html?&timestamp="+o.timestamp;$(".tozhifubao").attr("href",e),o.sendNum=0,o.orderStatus()},alipay:function(){o.Lock=!0,$(".mask").hide(),$(".wechat-pay-container").hide(),JKXY.pay.diaPay(),o.sendNum=999},decode:function(t){return decodeURIComponent(escape(window.atob(t)))},sendNum:0,orderStatus:function(){$.ajax({type:"get",cache:!1,url:"/vip/checkorder",dataType:"json",timeout:2e4,data:{timestamp:o.timestamp},success:function(t){200==t.code&&1==t.data.status?setTimeout(function(){o.setCookie(),window.location.href=t.data.return_url},1e3):200==t.code&&0==t.data.status?(o.sendNum++,o.sendNum<=400&&setTimeout(o.orderStatus,2e3),o.sendNum>400&&o.sendNum<=600&&setTimeout(o.orderStatus,3e3)):(alert(t.msg),console.log(t.msg))},error:function(){console.log("网络请求超时！"),alert("网络请求超时！")}})},setCookie:function(){var t=$.cookie("vip_status");if(1!=t){var e=window.location.host.split(".");$.cookie("vip_status","1",{path:"/",domain:"."+e[1]+"."+e[2],expires:7})}}},a.exports=o});